(function(n){"use strict";var r=function(n,t,i){return"http://api.flickr.com/services/rest/?method=flickr.photosets.getPhotos&api_key="+n+"&photoset_id="+t+"&per_page="+i+"&format=json&jsoncallback=?"},u=function(n,t,i){return"http://api.flickr.com/services/rest/?&method=flickr.people.getPublicPhotos&api_key="+n+"&user_id="+t+"&per_page="+i+"&format=json&jsoncallback=?"},f=function(n,t){return"http://api.flickr.com/services/rest/?&method=flickr.photos.getInfo&api_key="+n+"&photo_id="+t+"&format=json&jsoncallback=?"},i=function(n,t,i,r,u){return"http://farm"+n+".staticflickr.com/"+t+"/"+i+"_"+r+u+".jpg"},t;window.MSFlickr=function(t,i){var e={count:10,type:"photoset",desc:!0,title:!0,author:!0,thumbs:!0,descEff:"fade",titleEff:"fade",authorEff:"fade",autoplayDelay:4,thumbSize:"q",imgSize:"c"},f;if(this.count=0,this.slider=t,this.slider.preventInit=!0,!i.key){this.errMsg("Flickr API Key required. Please add it in gallery options.");return}n.extend(e,i),this.options=e,f=this,this.options.type==="photoset"?n.getJSON(r(this.options.key,this.options.id,this.options.count),function(n){f._photosData(n)}):n.getJSON(u(this.options.key,this.options.id,this.options.count),function(n){f.options.type="photos",f._photosData(n)}),this.options.imgSize!==""&&(this.options.imgSize="_"+this.options.imgSize),this.options.thumbSize="_"+this.options.thumbSize},t=MSFlickr.prototype,t._photosData=function(t){if(t.stat==="fail"){this.errMsg("Flickr API ERROR#"+t.code+": "+t.message);return}var r=this,u=this.options.author||this.options.desc;n.each(t[this.options.type].photo,function(t,e){var o='<div class="ms-slide" id="slide-'+t+'" data-delay="'+r.options.autoplayDelay+'">',s=e.title;o+='<img src="masterslider/blank.gif" data-src="'+i(e.farm,e.server,e.id,e.secret,r.options.imgSize)+'" alt="'+s+'" />',r.options.thumbs&&(o+='<img class="ms-thumb" src="'+i(e.farm,e.server,e.id,e.secret,r.options.thumbSize)+'" alt="'+s+'" />'),r.options.title&&(o+='<div class="ms-layer ms-fkr-title" data-effect="'+r.options.titleEff+'" data-duration = "1000"  data-ease = "easeOutQuad"  data-type = "text">'+s+"<\/div>"),o+="<\/div>",u&&(r.count++,n.getJSON(f(r.options.key,e.id),function(i){r.options.desc&&n("#slide-"+t).append('<div class="ms-layer ms-fkr-desc" data-effect="'+r.options.descEff+'" data-duration = "1000"  data-ease = "easeOutQuad"  data-type = "text">'+i.photo.description._content+"<\/div>"),r.options.author&&n("#slide-"+t).append('<div class="ms-layer ms-fkr-author" data-effect="'+r.options.authorEff+'" data-duration = "1000"  data-ease = "easeOutQuad"  data-type = "text">'+i.photo.owner.realname+"<\/div>"),r.count--,r.count===0&&r._initSlider()})),n(o).appendTo(r.slider.$element)}),this.count===0&&r._initSlider()},t.errMsg=function(t){this.slider.$element.css("display","block"),this.errEle||(this.errEle=n('<div style="font-family:Arial; color:red; font-size:12px; position:absolute; top:10px; left:10px"><\/div>').appendTo(this.slider.$loading)),this.errEle.html(t)},t._initSlider=function(){this.slider.preventInit=!1,this.slider._init()}})(jQuery)